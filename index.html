
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PiiComm Service Management Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .navbar-brand { font-weight: bold; color: #007bff !important; }
        .card-icon { font-size: 2rem; margin-bottom: 1rem; }
        .priority-critical { border-left: 5px solid #dc3545; }
        .priority-high { border-left: 5px solid #fd7e14; }
        .priority-medium { border-left: 5px solid #ffc107; }
        .priority-low { border-left: 5px solid #28a745; }
        .sla-warning { background-color: #fff3cd; }
        .sla-danger { background-color: #f8d7da; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#"><i class="fas fa-cogs me-2"></i>PiiComm Service Desk</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="#dashboard">Dashboard</a></li>
                    <li class="nav-item"><a class="nav-link" href="#create-ticket">Create Ticket</a></li>
                    <li class="nav-item"><a class="nav-link" href="#my-tickets">My Tickets</a></li>
                    <li class="nav-item"><a class="nav-link" href="#reports">Reports</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Dashboard Section -->
        <div id="dashboard" class="row mb-5">
            <div class="col-12"><h2 class="mb-4">Service Desk Dashboard</h2></div>
            <div class="col-md-3 mb-3">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-ticket-alt text-primary card-icon"></i>
                        <h5 class="card-title">Total Tickets</h5>
                        <h3 class="text-primary" id="total-tickets">0</h3>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-clock text-warning card-icon"></i>
                        <h5 class="card-title">Open Tickets</h5>
                        <h3 class="text-warning" id="open-tickets">0</h3>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-exclamation-triangle text-danger card-icon"></i>
                        <h5 class="card-title">SLA at Risk</h5>
                        <h3 class="text-danger" id="sla-risk">0</h3>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <i class="fas fa-check-circle text-success card-icon"></i>
                        <h5 class="card-title">Resolved Today</h5>
                        <h3 class="text-success" id="resolved-today">0</h3>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create Ticket Form -->
        <div id="create-ticket" class="row mb-5" style="display: none;">
            <div class="col-12"><h2 class="mb-4">Create New Ticket</h2></div>
            <div class="col-md-8">
                <form id="ticketForm">
                    <div class="mb-3">
                        <label class="form-label">Title *</label>
                        <input type="text" class="form-control" id="ticketTitle" required>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Category *</label>
                            <select class="form-select" id="ticketCategory" required>
                                <option value="">Select Category</option>
                                <option value="IT Support">IT Support</option>
                                <option value="Software Request">Software Request</option>
                                <option value="Hardware Request">Hardware Request</option>
                                <option value="Access Request">Access Request</option>
                                <option value="Bug Report">Bug Report</option>
                                <option value="Feature Request">Feature Request</option>
                                <option value="General Inquiry">General Inquiry</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Priority</label>
                            <select class="form-select" id="ticketPriority">
                                <option value="Low">Low</option>
                                <option value="Medium" selected>Medium</option>
                                <option value="High">High</option>
                                <option value="Critical">Critical</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Description *</label>
                        <textarea class="form-control" id="ticketDescription" rows="4" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Reporter Email *</label>
                        <input type="email" class="form-control" id="ticketReporter" required>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-plus me-2"></i>Create Ticket
                    </button>
                </form>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-info-circle me-2"></i>AI Assistant</h5>
                    </div>
                    <div class="card-body" id="ai-suggestions">
                        <p class="text-muted">Fill out the form to get AI-powered suggestions for priority and routing.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tickets List -->
        <div id="my-tickets" class="row mb-5" style="display: none;">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h2>My Tickets</h2>
                    <div class="btn-group">
                        <button class="btn btn-outline-secondary" onclick="filterTickets('all')">All</button>
                        <button class="btn btn-outline-secondary" onclick="filterTickets('open')">Open</button>
                        <button class="btn btn-outline-secondary" onclick="filterTickets('resolved')">Resolved</button>
                    </div>
                </div>
                <div id="tickets-container">
                    <div class="text-center text-muted">
                        <i class="fas fa-inbox fa-3x mb-3"></i>
                        <p>No tickets found</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reports Section -->
        <div id="reports" class="row mb-5" style="display: none;">
            <div class="col-12"><h2 class="mb-4">Reports & Analytics</h2></div>
            <div class="col-md-6 mb-4">
                <div class="card">
                    <div class="card-header">
                        <h5>Tickets by Priority</h5>
                    </div>
                    <div class="card-body">
                        <canvas id="priorityChart" width="400" height="200"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-4">
                <div class="card">
                    <div class="card-header">
                        <h5>SLA Compliance</h5>
                    </div>
                    <div class="card-body">
                        <canvas id="slaChart" width="400" height="200"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-light py-4 mt-5">
        <div class="container text-center">
            <p class="text-muted mb-0">
                PiiComm Service Management System &copy; 2024 | 
                Powered by AI & Pipedream
            </p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const https://eoxxx.m.pipedream.net = 'YOUR_PIPEDREAM_WORKFLOW_URL';
        
        // Navigation
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const target = e.target.getAttribute('href').substring(1);
                showSection(target);
            });
        });
        
        function showSection(sectionId) {
            document.querySelectorAll('[id]').forEach(el => {
                if (el.id.includes('-') && el.style) {
                    el.style.display = 'none';
                }
            });
            const section = document.getElementById(sectionId);
            if (section) section.style.display = 'block';
            
            if (sectionId === 'dashboard') loadDashboard();
            if (sectionId === 'my-tickets') loadTickets();
            if (sectionId === 'reports') loadReports();
        }
        
        // Ticket Form
        document.getElementById('ticketForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const ticketData = {
                title: document.getElementById('ticketTitle').value,
                category: document.getElementById('ticketCategory').value,
                priority: document.getElementById('ticketPriority').value,
                description: document.getElementById('ticketDescription').value,
                reporter: document.getElementById('ticketReporter').value
            };
            
            try {
                const response = await fetch(https://eoxxx.m.pipedream.net, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        operation: 'create_ticket',
                        ticketData: ticketData
                    })
                });
                
                const result = await response.json();
                alert('Ticket created successfully! ID: ' + result.ticketId);
                document.getElementById('ticketForm').reset();
                
            } catch (error) {
                alert('Error creating ticket: ' + error.message);
            }
        });
        
        // Load functions
        async function loadDashboard() {
            try {
                const response = await fetch(https://eoxxx.m.pipedream.net + '?operation=generate_report');
                const report = await response.json();
                
                document.getElementById('total-tickets').textContent = report.totalTickets;
                document.getElementById('open-tickets').textContent = 
                    (report.byStatus['New'] || 0) + (report.byStatus['In Progress'] || 0);
                document.getElementById('sla-risk').textContent = report.slaCompliance.atRisk;
                document.getElementById('resolved-today').textContent = 
                    report.byStatus['Resolved'] || 0;
            } catch (error) {
                console.error('Error loading dashboard:', error);
            }
        }
        
        async function loadTickets() {
            try {
                const response = await fetch(https://eoxxx.m.pipedream.net + '?operation=list_tickets');
                const tickets = await response.json();
                
                const container = document.getElementById('tickets-container');
                if (tickets.length === 0) {
                    container.innerHTML = '<div class="text-center text-muted"><i class="fas fa-inbox fa-3x mb-3"></i><p>No tickets found</p></div>';
                    return;
                }
                
                container.innerHTML = tickets.map(ticket => 
                    '<div class="card mb-3 priority-' + ticket.priority.toLowerCase() + '">' +
                    '<div class="card-body">' +
                    '<div class="d-flex justify-content-between">' +
                    '<h5 class="card-title">' + ticket.title + '</h5>' +
                    '<span class="badge bg-' + getStatusColor(ticket.status) + '">' + ticket.status + '</span>' +
                    '</div>' +
                    '<p class="card-text">' + ticket.description + '</p>' +
                    '<small class="text-muted">ID: ' + ticket.ticketId + ' | Priority: ' + ticket.priority + ' | Created: ' + new Date(ticket.createdAt).toLocaleDateString() + '</small>' +
                    '</div></div>'
                ).join('');
            } catch (error) {
                console.error('Error loading tickets:', error);
            }
        }
        
        function getStatusColor(status) {
            const colors = {
                'New': 'primary',
                'In Progress': 'warning',
                'Pending': 'info',
                'Resolved': 'success',
                'Closed': 'secondary',
                'Cancelled': 'danger'
            };
            return colors[status] || 'secondary';
        }
        
        // Initialize
        showSection('dashboard');
    </script>
</body>
</html>
      